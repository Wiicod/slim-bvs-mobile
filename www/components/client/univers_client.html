<div id="client" class="commande-container" style="overflow: hidden">
    <div class="clearfix"></div>
    <div class="row-fluid" style="margin-top: 10px;">
        <div class="col-lg-12 col-md-12 col-sm-12" style="margin-bottom: 5px">
            <div class="col-lg-3 col-sm-3 col-md-3" >
                <fieldset>
                    <legend translate>UNIVERS_CLIENT.TITRE_1</legend>
                    <div class="col-lg-12 col-md-12 col-sm-12">
                        <input class="form-control" ng-model="search_client" placeholder="Rechercher client" type="text">
                    </div>
                    <div class="clearfix"></div>
                    <div class="scroll-categorie">
                        <div infinite-scroll='nextPage()'
                             infinite-scroll-disabled='inf_cat.busy'
                             infinite-scroll-container="'.scroll-categorie'"
                             infinite-scroll-distance='0.05'
                             infinite-scroll-parent="true">
                            <div class="categorie" ng-repeat="c in clients|filter:search_client|orderBy:'-name':true"
                                 ng-class="{'active':F.id==c.id}"
                                 ng-click="choix_client(c)">
                                {{c.name}}
                            </div>
                            <div class="text-center loading" ng-show='inf_cus.busy'><i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i></div>
                        </div>

                    </div>
                </fieldset>
            </div>
            <div class="col-lg-9 col-sm-9 col-md-9">
                <fieldset>
                    <legend translate>UNIVERS_CLIENT.TITRE_2</legend>
                    <div class="scroll-univers scroll-produit" >
                        <div ng-if="choix==true" class="">
                            <ul class="nav nav-tabs" role="tablist">
                                <li role="presentation" class="active">
                                    <a href="/#detail" aria-controls="detail" role="tab" data-toggle="tab" translate>UNIVERS_CLIENT.ARG_1</a>
                                </li>
                                <li role="presentation">
                                    <a href="/#plan" aria-controls="plan" role="tab" data-toggle="tab" translate>UNIVERS_CLIENT.ARG_2</a>
                                </li>
                                <li role="presentation"><a href="/#historique" aria-controls="historique" role="tab" data-toggle="tab" translate>UNIVERS_CLIENT.ARG_3</a></li>
                                <li role="presentation"><a href="/#partage" aria-controls="partage" role="tab" data-toggle="tab" translate>UNIVERS_CLIENT.ARG_4</a></li>
                            </ul>

                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div role="tabpanel" class="tab-pane" id="detail">
                                    <div class="row-fluid detail">
                                        <div class="col-lg-6 col-sm-6 col-md-6">
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_5</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.name}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_7</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.email}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_8</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.phone}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_9</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.address}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_10</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.post_box}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_11</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.town.name}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_12</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.town.region.country.name}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_13</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.customer_type.name}} | {{client.customer_type.discount}}%</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_14</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.birthdate}}</div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6 col-sm-6 col-md-6">
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_15</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.company.name}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_16</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.company.rccm}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_17</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.company.taxpayer_number}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_8</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.company.phone}}</div>
                                            </div>
                                            <div class="row-fliud clearfix">
                                                <div class="col-lg-3 col-sm-3 col-md-3" translate>UNIVERS_CLIENT.ARG_10</div>
                                                <div class="col-lg-9 col-sm-9 col-md-9">{{client.company.post_box}}</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane" id="plan">
                                    <div class="row-fluid" ng-if="plan!=false">
                                        <div id="map" class="col-lg-12 col-sm-12 col-md-12">
                                            <ng-map zoom="20"
                                                    center="{{position}}"
                                                    style="height:90%" >
                                                <directions
                                                        draggable="false"
                                                        panel="directions-panel"
                                                        travel-mode="DRIVING"
                                                        origin="{{position}}"
                                                        destination="{{client.latitude}},{{client.longitude}}">
                                                </directions>
                                                <custom-marker id="start"
                                                               position="{{lat}},{{lng}}">
                                                    <div translate>UNIVERS_CLIENT.ARG_18 </div>
                                                </custom-marker>
                                                <custom-marker id="end"
                                                               position="{{client.latitude}},{{client.longitude}}">
                                                    <div translate>UNIVERS_CLIENT.ARG_19 </div>
                                                </custom-marker>
                                            </ng-map>
                                        </div>
                                    </div>
                                    <div class="row-fluid" ng-if="plan==false">
                                        <div class="col-lg-6 col-sm-6 col-md-6 col-lg-offset-3 col-sm-offset-3 col-md-offset-3 text-center" style="padding-top: 50px">
                                            <p translate>UNIVERS_CLIENT.ARG_20</p>
                                            <p><span translate>UNIVERS_CLIENT.ARG_21</span><strong translate>UNIVERS_CLIENT.ARG_22</strong> <span translate>UNIVERS_CLIENT.ARG_23</span></p>
                                            <div class="btn btn-primary btn-raised" ng-click="coordonnees_client(client)" translate>
                                                UNIVERS_CLIENT.ARG_22
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane active" id="historique">
                                    <div class="row-fluid hide">
                                        <div class="col-lg-1 col-sm-1 col-md-1">
                                            <h5 translate>UNIVERS_CLIENT.ARG_24</h5>
                                        </div>
                                        <div class="col-lg-5 col-sm-5 col-md-5">
                                            <div class="dropdown">
                                                <a class="dropdown-toggle" id="dropdownStart" role="button" data-toggle="dropdown" data-target=".dropdown-start-parent"
                                                        >
                                                    <div class="input-group date">
                                                        <input type="text" class="form-control" data-ng-model="dateRangeStart">
                                                        <span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
                                                    </div>
                                                </a>
                                                <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                                                    <datetimepicker data-ng-model="dateRangeStart"
                                                                    data-datetimepicker-config="{ dropdownSelector: '#dropdownStart', renderOn: 'end-date-changed',startView:'day', minView:'day' }"
                                                                    ></datetimepicker>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>
                                    <div class="col-lg-9 col-sm-8 col-md-9 scroll-historique">
                                        <div class="row categorie" style="background: #000;color: #debc6e;">
                                            <div class="row-fluid">
                                                <div class="col-lg-1 col-sm-1 col-md-1">
                                                    #
                                                </div>
                                                <div class="col-lg-5 col-sm-5 col-md-5">
                                                    Statut
                                                </div>
                                                <div class="col-lg-2 col-sm-2 col-md-2">
                                                    Date
                                                </div>
                                                <div class="col-lg-4 col-sm-4 col-md-4 text-right">
                                                    Prix
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row categorie" ng-repeat="f in client.bills | orderBy : '-created_at':true"
                                             ng-class="{'bg-secondary':f.status=='expired','bg-primary':f.status=='waiting_customer_approval','bg-text':f.status=='canceled'}"
                                             ng-click="detail_facture(f)" >
                                            <div class="row-fluid">
                                                <div class="col-lg-1 col-sm-1 col-md-1">
                                                    {{f.id}}
                                                </div>
                                                <div class="col-lg-5 col-sm-5 col-md-5">
                                                    <span>{{f.status|billStatus}}</span>
                                                </div>
                                                <div class="col-lg-2 col-sm-2 col-md-2">
                                                    {{f.created_at|limitTo:10}}
                                                </div>
                                                <div class="col-lg-4 col-sm-4 col-md-4 text-right">
                                                    {{f.amount|roundCoin : 1 : true}} Fcfa
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-3 col-sm-4 col-md-3">
                                        <fieldset style="margin-bottom: 10%">
                                            <legend translate>UNIVERS_CLIENT.ARG_25</legend>
                                            <div class="text-center">
                                                <h3 class="value">{{client.ca |roundCoin : 1 : true}} Fcfa</h3>
                                            </div>
                                        </fieldset>
                                        <fieldset style="margin-bottom: 10%">
                                            <legend translate>UNIVERS_CLIENT.ARG_26</legend>
                                            <div class="text-center">
                                                <h3 class="value">{{client.amount|roundCoin : 1 : true}} Fcfa</h3>
                                            </div>
                                        </fieldset>
                                        <fieldset>
                                            <legend translate>UNIVERS_CLIENT.ARG_27</legend>
                                            <div class="text-center">
                                                <h3 class="value">{{client.echue}}</h3>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                                <div role="tabpanel" class="tab-pane" id="partage">
                                    <div class="col-lg-6 col-sm-6 col-md-6 col-lg-offset-3 col-sm-offset-3 col-md-offset-3 text-center" style="padding-top: 50px">
                                        <h3 translate>UNIVERS_CLIENT.ARG_28</h3>
                                        <p translate>UNIVERS_CLIENT.ARG_29</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div ng-if="choix==false">
                            <div class="row-fluid">
                                <div class="col-lg-6 col-sm-6 col-md-6 col-lg-offset-3 col-sm-offset-3 col-md-offset-3 text-center" style="padding-top: 50px">
                                    <p translate>UNIVERS_CLIENT.ARG_30</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
    </div>

    <button id="btn_detail_facture" data-toggle="modal" data-target="#detail_facture" class="hide"></button>
    <div class="modal" id="detail_facture">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">
                        {{facture.customer.name}} | {{facture.customer.customer_type.name}} | {{facture.discount*100}}%
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-6 col-sm-6 col-md-6">
                            <fieldset>
                                <legend translate>HISTORIQUE.TITRE_2</legend>
                                <div class="commande">
                                    <div class="scroll-commande">
                                        <div class="row-fluid">
                                            <div class="col-lg-9 col-sm-9 col-md-9" translate>HISTORIQUE.ARG_4</div>
                                        </div>
                                        <div class="clearfix"></div>
                                        <div class="categorie row" ng-repeat="p in facture.product_saletypes" ng-click="detail_produit(n)">
                                            <div class="col-lg-9 col-sm-9 col-md-9 no-padding-lr">{{p.pivot.quantity}} {{p.product.name}}</div>
                                            <div class="col-lg-3 col-sm-3 col-md-3 no-padding-lr">{{p.pivot.quantity*p.pivot.product_price_was}}</div>
                                        </div>
                                    </div>
                                    <div class="montant">
                                        <div class="row" >
                                            <div class="col-lg-3 col-sm-3 col-md-3" translate>HISTORIQUE.ARG_6</div>
                                            <div class="col-lg-9 col-sm-9 col-md-9 text-right">{{facture.prix_sans_remise| roundCoin : 1 : true}} Fcfa</div>
                                        </div>
                                        <div class="row" >
                                            <div class="col-lg-3 col-sm-3 col-md-3" translate>HISTORIQUE.ARG_7</div>
                                            <div class="col-lg-9 col-sm-9 col-md-9 text-right">{{facture.prix_remise| roundCoin : 1 : true}} Fcfa</div>
                                        </div>
                                        <div class="row" >
                                            <div class="col-lg-3 col-sm-3 col-md-3" translate>HISTORIQUE.ARG_8</div>
                                            <div class="col-lg-9 col-sm-9 col-md-9 text-right">{{facture.amount| roundCoin : 1 : true}} Fcfa</div>
                                        </div>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                        <div class="col-lg-6 col-sm-6 col-md-6">
                            <fieldset style="margin-bottom: 20%">
                                <legend translate>HISTORIQUE.TITRE_3</legend>
                                <div class="row-fluid clearfix">
                                    <div class="col-lg-6 col-sm-6 col-md-6 bold" translate>HISTORIQUE.ARG_9
                                    </div>
                                    <div class="col-lg-6 col-sm-6 col-md-6">
                                        <span>{{facture.status|billStatus}}</span>

                                    </div>
                                </div>
                                <div class="row-fluid clearfix">
                                    <div class="col-lg-6 col-sm-6 col-md-6 bold" translate>HISTORIQUE.ARG_10
                                    </div>
                                    <div class="col-lg-6 col-sm-6 col-md-6">
                                        {{facture.amount| roundCoin : 1 : true}} Fcfa
                                    </div>
                                </div>
                                <div class="row-fluid clearfix">
                                    <div class="col-lg-6 col-sm-6 col-md-6 bold" translate>UNIVERS_CLIENT.ARG_32
                                    </div>
                                    <div class="col-lg-6 col-sm-6 col-md-6">
                                        {{facture.paymentmethod.title}}
                                    </div>
                                </div>
                                <div class="row-fluid clearfix">
                                    <div class="col-lg-6 col-sm-6 col-md-6 bold" translate>HISTORIQUE.ARG_11
                                    </div>
                                    <div class="col-lg-6 col-sm-6 col-md-6">
                                        {{facture.deadline}}
                                    </div>
                                </div>
                                <div class="row-fluid clearfix">
                                    <div class="col-lg-6 col-sm-6 col-md-6 bold" translate>HISTORIQUE.ARG_12
                                    </div>
                                    <div class="col-lg-6 col-sm-6 col-md-6">
                                        {{facture.created_at}}
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-raised" ng-click="imprimer()" ng-if="facture.status=='paided'" translate>HISTORIQUE.ARG_13</button>
                    <button type="button" class="btn btn-raised btn-info" ng-click="notifier_client()" ng-if="facture.status=='waiting_customer_approval'" translate>HISTORIQUE.ARG_14</button>
                    <button type="button" class="btn btn-raised btn-danger" data-toggle="modal"  ng-if="facture.status=='paided'" data-target="#extourne" translate>HISTORIQUE.ARG_15</button>
                    <button type="button" class="btn btn-raised btn-primary" data-dismiss="modal" translate>HISTORIQUE.ARG_16</button>
                </div>
            </div>
        </div>
    </div>
</div>